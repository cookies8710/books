% todo u, v, w should not apply vector addition, but define vectors which should be handled by operations
% todo cont. then w won't be needed at all

/h {3 sqrt} def

/hexagon % draws hexagon with center tx, ty, with radius a
{ 
	/a exch def
	/ty exch def
	/tx exch def

	tx ty translate
	newpath
	0 a moveto
	a h 2 div mul a 2 div lineto
	a h 2 div mul a 2 div neg lineto
	0 a neg lineto
	a h 2 div mul neg a 2 div neg lineto
	a h 2 div mul neg a 2 div lineto
	0 a lineto
	stroke
	tx neg ty neg translate
} def


% u -> 0 deg vector; tx ty a -> tx' ty a
/u {
	/a exch def
	/ty exch def
	/tx exch def

	% tx' = tx + sqrt(3) * a
	tx h a mul add ty a
} def
% v -> 60 deg vector; tx ty a -> tx' ty' a
/v {
	/a exch def
	/ty exch def
	/tx exch def

	% tx' = tx + sqrt(3) / 2 * a
	% ty' = ty + 3 / 2 * a
	tx h a 2 div mul add ty 1.5 a mul add a
} def
% w -> 90 deg vector; tx ty a -> tx ty' a
/w {
	/a exch def
	/ty exch def
	/tx exch def

	tx ty a 3 mul add a
} def

% todo nx, ny: 700, 600 should be taken from page size
/a 5 def % hexagon's circle radius
/nx {700 a 2 mul div} def
/ny {600 a 2 mul div} def

0 1 ny {
  /i exch def
   0 1 nx { 
	/n exch def
	0 0 a i {w} repeat n {u} repeat  hexagon
	0 0 a i {w} repeat v n {u} repeat  hexagon
       } for
} for

showpage
